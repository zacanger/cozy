let test = fn(suite, cb) {
    # 'test takes a suite name and a callbac. the callback should
    # take a parameter which is an assertion, which takes a value and optionally
    # a message to print on failure.'

    mutable id = 0;
    mutable failed = 0;

    printf("# %s\n", suite);

    let handle_assertion = fn(val, msg = "Result was not 'true'!") {
        id++;
        if (!val) {
            printf("not ok %d - %s\n", id, msg);
            failed++;
        } else {
            printf("ok %d - %s\n", id, msg);
        }
    };

    cb(handle_assertion);

    # Print total amount of tests
    printf("1..%d\n", id);
};
